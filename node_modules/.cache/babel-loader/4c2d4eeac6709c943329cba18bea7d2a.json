{"ast":null,"code":"var _jsxFileName = \"D:\\\\Front_end _CyberSoft\\\\CodeMau_Poker\\\\src\\\\components\\\\Control\\\\index.jsx\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport { useEffect } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useCallback } from \"react\"; // import Player from \"../Player\";\n// use Selector có tác dụng nếu lấy dữ liệu trên store về thay đổi giá trị thì sẽ render lại component\n//ueStore có tác dụng chỉ lấy dữ liệu trên store về sử dụng , dữ liệu thay đổi ko ảnh hưởng render\n\nconst Control = () => {\n  const deckCard = useSelector(state => {\n    return state.card.deckCard;\n  });\n  const playerList = useSelector(state => {\n    return state.player.playerList;\n  });\n  const countTurnPlay = useSelector(state => {\n    return state.card.countTurnPlay;\n  });\n  console.log(countTurnPlay); // const useStore = useStore();\n\n  const dispatch = useDispatch();\n  const shuffleCards = useCallback(() => {\n    axios({\n      url: `https://deckofcardsapi.com/api/deck/${deckCard.deck_id}/shuffle/`,\n      method: \"GET\"\n    }).then(res => {\n      dispatch({\n        type: \"SHUFFLE_CARDS\",\n        payload: res.data\n      });\n    }).catch(err => console.log(err));\n    const players = [...playerList];\n    players.map(player => {\n      return { ...player,\n        ...(player.cards = [])\n      };\n    });\n    dispatch({\n      type: \"SET_PLAYERS\",\n      payload: players\n    });\n    dispatch({\n      type: \"REVEAL_CARDS\",\n      payload: false\n    });\n  }, [deckCard, dispatch, playerList]);\n  const drawCards = useCallback(() => {\n    axios({\n      method: \"GET\",\n      url: `https://deckofcardsapi.com/api/deck/${deckCard.deck_id}/draw/?count=12`\n    }).then(res => {\n      const players = [...playerList];\n      console.log(players);\n\n      for (const i in res.data.cards) {\n        const playerIndex = i % 4; // chia lấy dư  4\n        // i= 0 , playerIndex = 0 =>Card[0]=>player[0]\n        // ...\n        //i= 5 , playerIndex = 1 =>Card[5]=>player[1]\n\n        players[playerIndex].cards.push(res.data.cards[i]);\n      }\n\n      dispatch({\n        type: \"SET_PLAYERS\",\n        payload: players\n      }); // console.log(res.data.cards);\n    }).catch(err => {\n      console.log(err);\n    });\n  }, [deckCard, playerList, dispatch]);\n  const revealCards = useCallback(() => {\n    //1. lật bài\n    dispatch({\n      type: \"REVEAL_CARDS\",\n      payload: true\n    });\n    const result = [];\n    const players = [...playerList];\n    players.map(player => {\n      return { ...player,\n        ...(player.totalPoint -= 5000)\n      };\n    });\n    players.forEach(player => {\n      if (checkSpecialCard(player.cards) === 30) {\n        result.push(player);\n      }\n    });\n\n    if (result.length > 0) {\n      const diemCuoc = Math.round(20000 / result.length);\n      result.forEach(player => {\n        player.totalPoint += diemCuoc;\n      });\n    }\n\n    if (result.length === 0) {\n      const arrScore = players.map(player => {\n        return checkPoint(player.cards);\n      });\n      const maxScore = Math.max(...arrScore);\n      const playerMax = players.filter(player => checkPoint(player.cards) === maxScore);\n      const diemCuoc = Math.round(20000 / playerMax.length);\n      playerMax.forEach(player => {\n        return player.totalPoint += diemCuoc;\n      });\n    }\n\n    dispatch({\n      type: \"SET_PLAYERS\",\n      payload: players\n    });\n    dispatch({\n      type: \"SET_SHUFFLE\",\n      payload: false\n    });\n    dispatch({\n      type: \"TURN_GAME\"\n    });\n  }, [dispatch, playerList]); //Trường hợp đặc biệt\n\n  const checkSpecialCard = arrCard => {\n    let result = 0;\n    arrCard.forEach(card => {\n      if (card.value === \"JACK\" || card.value === \"QUEEN\" || card.value === \"KING\") {\n        result = +10;\n      }\n    });\n    return result;\n  }; //Trường hợp thường\n\n\n  const checkPoint = arrCard => {\n    let result = 0;\n    arrCard.forEach(card => {\n      if (card.value === \"JACK\" || card.value === \"QUEEN\" || card.value === \"KING\" || card.value === \"10\") {\n        result += 10;\n      } else if (card.value === \"ACE\") {\n        result += 1;\n      } else {\n        result += card.value * 1;\n      }\n    });\n    return result % 10;\n  };\n\n  useEffect(() => {\n    if (countTurnPlay === 5) {\n      const players = [...playerList];\n      const arrScore = players.map(player => {\n        return player.totalPoint;\n      });\n      const maxScore = Math.max(arrScore);\n      const playerWins = players.filter(player => {\n        return player.totalPoint === maxScore;\n      });\n      alert(\"Người chiến thắng : \" + playerWins.username);\n    }\n  }, [countTurnPlay, playerList]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex  justify-content-end container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"border d-flex justify-content-center align-items-center px-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-success mr-2\",\n    onClick: shuffleCards,\n    disabled: deckCard.shuffled,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 9\n    }\n  }, \"Shuffle\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: drawCards,\n    className: \"btn btn-info mr-2\",\n    disabled: !deckCard.shuffled || playerList[0].cards.length !== 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 9\n    }\n  }, \"Draw\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-primary mr-2\",\n    onClick: revealCards,\n    disabled: !deckCard.shuffled || playerList[0].cards.length === 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 9\n    }\n  }, \"Reveal\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 7\n    }\n  }, playerList.map(item => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: item.username,\n      className: \"border px-3 text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 15\n      }\n    }, item.username), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 15\n      }\n    }, \" \", item.totalPoint, \" \"));\n  })));\n};\n\nexport default Control;","map":{"version":3,"sources":["D:/Front_end _CyberSoft/CodeMau_Poker/src/components/Control/index.jsx"],"names":["React","axios","useEffect","useSelector","useDispatch","useCallback","Control","deckCard","state","card","playerList","player","countTurnPlay","console","log","dispatch","shuffleCards","url","deck_id","method","then","res","type","payload","data","catch","err","players","map","cards","drawCards","i","playerIndex","push","revealCards","result","totalPoint","forEach","checkSpecialCard","length","diemCuoc","Math","round","arrScore","checkPoint","maxScore","max","playerMax","filter","arrCard","value","playerWins","alert","username","shuffled","item"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport axios from \"axios\";\r\nimport { useEffect } from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { useCallback } from \"react\";\r\n// import Player from \"../Player\";\r\n// use Selector có tác dụng nếu lấy dữ liệu trên store về thay đổi giá trị thì sẽ render lại component\r\n//ueStore có tác dụng chỉ lấy dữ liệu trên store về sử dụng , dữ liệu thay đổi ko ảnh hưởng render\r\n\r\nconst Control = () => {\r\n  const deckCard = useSelector((state) => {\r\n    return state.card.deckCard;\r\n  });\r\n  const playerList = useSelector((state) => {\r\n    return state.player.playerList;\r\n  });\r\n  const countTurnPlay = useSelector((state) => {\r\n    return state.card.countTurnPlay;\r\n  });\r\n  console.log(countTurnPlay);\r\n\r\n  // const useStore = useStore();\r\n  const dispatch = useDispatch();\r\n\r\n  const shuffleCards = useCallback(() => {\r\n    axios({\r\n      url: `https://deckofcardsapi.com/api/deck/${deckCard.deck_id}/shuffle/`,\r\n      method: \"GET\",\r\n    })\r\n      .then((res) => {\r\n        dispatch({\r\n          type: \"SHUFFLE_CARDS\",\r\n          payload: res.data,\r\n        });\r\n      })\r\n      .catch((err) => console.log(err));\r\n    const players = [...playerList];\r\n    players.map((player) => {\r\n      return { ...player, ...(player.cards = []) };\r\n    });\r\n    dispatch({\r\n      type: \"SET_PLAYERS\",\r\n      payload: players,\r\n    });\r\n\r\n    dispatch({\r\n      type: \"REVEAL_CARDS\",\r\n      payload: false,\r\n    });\r\n  }, [deckCard, dispatch, playerList]);\r\n\r\n  const drawCards = useCallback(() => {\r\n    axios({\r\n      method: \"GET\",\r\n      url: `https://deckofcardsapi.com/api/deck/${deckCard.deck_id}/draw/?count=12`,\r\n    })\r\n      .then((res) => {\r\n        const players = [...playerList];\r\n        console.log(players);\r\n        for (const i in res.data.cards) {\r\n          const playerIndex = i % 4;\r\n          // chia lấy dư  4\r\n          // i= 0 , playerIndex = 0 =>Card[0]=>player[0]\r\n          // ...\r\n          //i= 5 , playerIndex = 1 =>Card[5]=>player[1]\r\n\r\n          players[playerIndex].cards.push(res.data.cards[i]);\r\n        }\r\n        dispatch({ type: \"SET_PLAYERS\", payload: players });\r\n        // console.log(res.data.cards);\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  }, [deckCard, playerList, dispatch]);\r\n  const revealCards = useCallback(() => {\r\n    //1. lật bài\r\n    dispatch({ type: \"REVEAL_CARDS\", payload: true });\r\n    const result = [];\r\n    const players = [...playerList];\r\n\r\n    players.map((player) => {\r\n      return { ...player, ...(player.totalPoint -= 5000) };\r\n    });\r\n    players.forEach((player) => {\r\n      if (checkSpecialCard(player.cards) === 30) {\r\n        result.push(player);\r\n      }\r\n    });\r\n    if (result.length > 0) {\r\n      const diemCuoc = Math.round(20000 / result.length);\r\n      result.forEach((player) => {\r\n        player.totalPoint += diemCuoc;\r\n      });\r\n    }\r\n    if (result.length === 0) {\r\n      const arrScore = players.map((player) => {\r\n        return checkPoint(player.cards);\r\n      });\r\n      const maxScore = Math.max(...arrScore);\r\n      const playerMax = players.filter(\r\n        (player) => checkPoint(player.cards) === maxScore\r\n      );\r\n      const diemCuoc = Math.round(20000 / playerMax.length);\r\n      playerMax.forEach((player) => {\r\n        return (player.totalPoint += diemCuoc);\r\n      });\r\n    }\r\n    dispatch({\r\n      type: \"SET_PLAYERS\",\r\n      payload: players,\r\n    });\r\n    dispatch({\r\n      type: \"SET_SHUFFLE\",\r\n      payload: false,\r\n    });\r\n    dispatch({\r\n      type: \"TURN_GAME\",\r\n    });\r\n  }, [dispatch, playerList]);\r\n\r\n  //Trường hợp đặc biệt\r\n  const checkSpecialCard = (arrCard) => {\r\n    let result = 0;\r\n    arrCard.forEach((card) => {\r\n      if (\r\n        card.value === \"JACK\" ||\r\n        card.value === \"QUEEN\" ||\r\n        card.value === \"KING\"\r\n      ) {\r\n        result = +10;\r\n      }\r\n    });\r\n    return result;\r\n  };\r\n  //Trường hợp thường\r\n  const checkPoint = (arrCard) => {\r\n    let result = 0;\r\n    arrCard.forEach((card) => {\r\n      if (\r\n        card.value === \"JACK\" ||\r\n        card.value === \"QUEEN\" ||\r\n        card.value === \"KING\" ||\r\n        card.value === \"10\"\r\n      ) {\r\n        result += 10;\r\n      } else if (card.value === \"ACE\") {\r\n        result += 1;\r\n      } else {\r\n        result += card.value * 1;\r\n      }\r\n    });\r\n    return result % 10;\r\n  };\r\n  useEffect(() => {\r\n    if (countTurnPlay === 5) {\r\n      const players = [...playerList];\r\n      const arrScore = players.map((player) => {\r\n        return player.totalPoint;\r\n      });\r\n      const maxScore = Math.max(arrScore);\r\n      const playerWins = players.filter((player) => {\r\n        return player.totalPoint === maxScore;\r\n      });\r\n\r\n      alert(\"Người chiến thắng : \" + playerWins.username);\r\n    }\r\n  }, [countTurnPlay, playerList]);\r\n\r\n  return (\r\n    <div className=\"d-flex  justify-content-end container\">\r\n      <div className=\"border d-flex justify-content-center align-items-center px-2\">\r\n        <button\r\n          className=\"btn btn-success mr-2\"\r\n          onClick={shuffleCards}\r\n          disabled={deckCard.shuffled}\r\n        >\r\n          Shuffle\r\n        </button>\r\n        <button\r\n          onClick={drawCards}\r\n          className=\"btn btn-info mr-2\"\r\n          disabled={!deckCard.shuffled || playerList[0].cards.length !== 0}\r\n        >\r\n          Draw\r\n        </button>\r\n        <button\r\n          className=\"btn btn-primary mr-2\"\r\n          onClick={revealCards}\r\n          disabled={!deckCard.shuffled || playerList[0].cards.length === 0}\r\n        >\r\n          Reveal\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"d-flex\">\r\n        {playerList.map((item) => {\r\n          return (\r\n            <div key={item.username} className=\"border px-3 text-center\">\r\n              <p>{item.username}</p>\r\n              <p> {item.totalPoint} </p>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Control;\r\n"]},"metadata":{},"sourceType":"module"}